{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.219.0"},"children":{"MosaicLifeStack":{"id":"MosaicLifeStack","path":"MosaicLifeStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.219.0"},"children":{"MosaicVPC":{"id":"MosaicVPC","path":"MosaicLifeStack/MosaicVPC","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]},"children":{"PublicSubnet1":{"id":"PublicSubnet1","path":"MosaicLifeStack/MosaicVPC/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"PublicSubnet2":{"id":"PublicSubnet2","path":"MosaicLifeStack/MosaicVPC/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"PublicSubnet3":{"id":"PublicSubnet3","path":"MosaicLifeStack/MosaicVPC/PublicSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"MosaicLifeStack/MosaicVPC/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"MosaicLifeStack/MosaicVPC/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"PrivateSubnet3":{"id":"PrivateSubnet3","path":"MosaicLifeStack/MosaicVPC/PrivateSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}}}},"HostedZone":{"id":"HostedZone","path":"MosaicLifeStack/HostedZone","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Certificate":{"id":"Certificate","path":"MosaicLifeStack/Certificate","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.Certificate","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/Certificate/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.CfnCertificate","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CertificateManager::Certificate","aws:cdk:cloudformation:props":{"domainName":"mosaiclife.me","domainValidationOptions":[{"domainName":"mosaiclife.me","hostedZoneId":"Z039487930F6987CJO4W9"},{"domainName":"frontend.mosaiclife.me","hostedZoneId":"Z039487930F6987CJO4W9"},{"domainName":"backend.mosaiclife.me","hostedZoneId":"Z039487930F6987CJO4W9"},{"domainName":"graph.mosaiclife.me","hostedZoneId":"Z039487930F6987CJO4W9"},{"domainName":"chat.mosaiclife.me","hostedZoneId":"Z039487930F6987CJO4W9"}],"subjectAlternativeNames":["*.mosaiclife.me","frontend.mosaiclife.me","backend.mosaiclife.me","graph.mosaiclife.me","chat.mosaiclife.me"],"tags":[{"key":"Name","value":"MosaicLifeStack/Certificate"}],"validationMethod":"DNS"}}}}},"UserPool":{"id":"UserPool","path":"MosaicLifeStack/UserPool","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]},"children":{"CognitoDomain":{"id":"CognitoDomain","path":"MosaicLifeStack/UserPool/CognitoDomain","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolDomain","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/UserPool/CognitoDomain/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolDomain","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolDomain","aws:cdk:cloudformation:props":{"domain":"mosaic-prod-033691785857","userPoolId":"us-east-1_JLppKC09m"}}}}},"WebAppClient":{"id":"WebAppClient","path":"MosaicLifeStack/UserPool/WebAppClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/UserPool/WebAppClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"accessTokenValidity":60,"allowedOAuthFlows":["code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["email","openid","profile"],"callbackUrLs":["https://mosaiclife.me/auth/callback","https://frontend.mosaiclife.me/auth/callback","http://localhost:5173/auth/callback"],"clientName":"mosaic-web-client","enableTokenRevocation":true,"explicitAuthFlows":["ALLOW_USER_PASSWORD_AUTH","ALLOW_CUSTOM_AUTH","ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"generateSecret":true,"idTokenValidity":60,"logoutUrLs":["https://mosaiclife.me","https://frontend.mosaiclife.me","http://localhost:5173"],"preventUserExistenceErrors":"ENABLED","refreshTokenValidity":43200,"supportedIdentityProviders":["COGNITO"],"tokenValidityUnits":{"idToken":"minutes","accessToken":"minutes","refreshToken":"minutes"},"userPoolId":"us-east-1_JLppKC09m"}}}}}}},"GoogleProvider":{"id":"GoogleProvider","path":"MosaicLifeStack/GoogleProvider","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolIdentityProviderGoogle","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/GoogleProvider/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolIdentityProvider","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolIdentityProvider","aws:cdk:cloudformation:props":{"attributeMapping":{"email":"email","given_name":"given_name","family_name":"family_name"},"providerDetails":{"client_id":"86995776201-js969aenuqmo4lv57g4m6s61if806qvn.apps.googleusercontent.com","client_secret":"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","authorize_scopes":"profile email openid"},"providerName":"Google","providerType":"Google","userPoolId":"us-east-1_JLppKC09m"}}}}},"GitHubProvider":{"id":"GitHubProvider","path":"MosaicLifeStack/GitHubProvider","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolIdentityProviderOidc","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/GitHubProvider/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolIdentityProvider","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolIdentityProvider","aws:cdk:cloudformation:props":{"attributeMapping":{"email":"email","given_name":"name"},"providerDetails":{"client_id":"Ov23liHAcqMT1YODD2y4","client_secret":"d75eeb7ad4d681da88001009e7ca3be28a2d5f1a","authorize_scopes":"openid email profile","attributes_request_method":"GET","oidc_issuer":"https://token.actions.githubusercontent.com"},"providerName":"GitHub","providerType":"OIDC","userPoolId":"us-east-1_JLppKC09m"}}}}},"CognitoConfig":{"id":"CognitoConfig","path":"MosaicLifeStack/CognitoConfig","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/CognitoConfig/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Cognito configuration for Mosaic Life","name":"mosaic/prod/cognito-config","secretString":{"Fn::Join":["",["{\"userPoolId\":\"us-east-1_JLppKC09m\",\"userPoolClientId\":\"",{"Ref":"UserPoolWebAppClientCD2D5CB1"},"\",\"userPoolDomain\":\"",{"Ref":"UserPoolCognitoDomainD6C7F9FA"},"\",\"region\":\"us-east-1\"}"]]}}}}}},"MediaBucket":{"id":"MediaBucket","path":"MosaicLifeStack/MediaBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}},"BackupBucket":{"id":"BackupBucket","path":"MosaicLifeStack/BackupBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.219.0","metadata":[]}},"webRepository":{"id":"webRepository","path":"MosaicLifeStack/webRepository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.219.0","metadata":[]}},"coreApiRepository":{"id":"coreApiRepository","path":"MosaicLifeStack/coreApiRepository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.219.0","metadata":[]}},"DomainEventsTopic":{"id":"DomainEventsTopic","path":"MosaicLifeStack/DomainEventsTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/DomainEventsTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"Mosaic Life Domain Events","topicName":"mosaic-prod-domain-events"}}}}},"EventsDLQ":{"id":"EventsDLQ","path":"MosaicLifeStack/EventsDLQ","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/EventsDLQ/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"messageRetentionPeriod":1209600,"queueName":"mosaic-prod-events-dlq"}}}}},"EventsQueue":{"id":"EventsQueue","path":"MosaicLifeStack/EventsQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/EventsQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"queueName":"mosaic-prod-events","redrivePolicy":{"deadLetterTargetArn":{"Fn::GetAtt":["EventsDLQ3D9C0575","Arn"]},"maxReceiveCount":3},"visibilityTimeout":300}}},"Policy":{"id":"Policy","path":"MosaicLifeStack/EventsQueue/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.QueuePolicy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/EventsQueue/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueuePolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::QueuePolicy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"sqs:SendMessage","Condition":{"ArnEquals":{"aws:SourceArn":{"Ref":"DomainEventsTopic9EECFB64"}}},"Effect":"Allow","Principal":{"Service":"sns.amazonaws.com"},"Resource":{"Fn::GetAtt":["EventsQueueB96EB0D2","Arn"]}}],"Version":"2012-10-17"},"queues":[{"Ref":"EventsQueueB96EB0D2"}]}}}}},"MosaicLifeStackDomainEventsTopic693AF0EA":{"id":"MosaicLifeStackDomainEventsTopic693AF0EA","path":"MosaicLifeStack/EventsQueue/MosaicLifeStackDomainEventsTopic693AF0EA","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Subscription","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/EventsQueue/MosaicLifeStackDomainEventsTopic693AF0EA/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnSubscription","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Subscription","aws:cdk:cloudformation:props":{"endpoint":{"Fn::GetAtt":["EventsQueueB96EB0D2","Arn"]},"protocol":"sqs","topicArn":{"Ref":"DomainEventsTopic9EECFB64"}}}}}}}},"CoreApiRole":{"id":"CoreApiRole","path":"MosaicLifeStack/CoreApiRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.219.0","metadata":[]},"children":{"ImportCoreApiRole":{"id":"ImportCoreApiRole","path":"MosaicLifeStack/CoreApiRole/ImportCoreApiRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.219.0","metadata":[]}},"Resource":{"id":"Resource","path":"MosaicLifeStack/CoreApiRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRoleWithWebIdentity","Condition":{"StringEquals":{"oidc.eks.${this.region}.amazonaws.com/id/CLUSTER_ID:sub":"system:serviceaccount:mosaiclife:core-api","oidc.eks.${this.region}.amazonaws.com/id/CLUSTER_ID:aud":"sts.amazonaws.com"}},"Effect":"Allow","Principal":{"Federated":"arn:aws:iam::033691785857:oidc-provider/oidc.eks.us-east-1.amazonaws.com/id/CLUSTER_ID"}}],"Version":"2012-10-17"},"description":"IAM role for core-api service in EKS","roleName":"mosaic-prod-core-api-role"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"MosaicLifeStack/CoreApiRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.219.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"MosaicLifeStack/CoreApiRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.219.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:Abort*","s3:DeleteObject*","s3:GetBucket*","s3:GetObject*","s3:List*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":["arn:aws:s3:::mosaic-prod-backups-033691785857","arn:aws:s3:::mosaic-prod-backups-033691785857/*","arn:aws:s3:::mosaic-prod-media-033691785857","arn:aws:s3:::mosaic-prod-media-033691785857/*"]},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":{"Ref":"CognitoConfig0041A066"}},{"Action":"sns:Publish","Effect":"Allow","Resource":{"Ref":"DomainEventsTopic9EECFB64"}},{"Action":["sqs:ChangeMessageVisibility","sqs:DeleteMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl","sqs:ReceiveMessage"],"Effect":"Allow","Resource":{"Fn::GetAtt":["EventsQueueB96EB0D2","Arn"]}}],"Version":"2012-10-17"},"policyName":"CoreApiRoleDefaultPolicy532B5FA2","roles":[{"Ref":"CoreApiRoleFD696CAE"}]}}}}}}},"VpcId":{"id":"VpcId","path":"MosaicLifeStack/VpcId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"CertificateArn":{"id":"CertificateArn","path":"MosaicLifeStack/CertificateArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"UserPoolId":{"id":"UserPoolId","path":"MosaicLifeStack/UserPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"UserPoolClientId":{"id":"UserPoolClientId","path":"MosaicLifeStack/UserPoolClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"UserPoolDomain":{"id":"UserPoolDomain","path":"MosaicLifeStack/UserPoolDomain","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"MediaBucketName":{"id":"MediaBucketName","path":"MosaicLifeStack/MediaBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"DomainEventsTopicArn":{"id":"DomainEventsTopicArn","path":"MosaicLifeStack/DomainEventsTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"HostedZoneId":{"id":"HostedZoneId","path":"MosaicLifeStack/HostedZoneId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"webRepositoryUri":{"id":"webRepositoryUri","path":"MosaicLifeStack/webRepositoryUri","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"coreApiRepositoryUri":{"id":"coreApiRepositoryUri","path":"MosaicLifeStack/coreApiRepositoryUri","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.219.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"MosaicLifeStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"MosaicLifeStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.219.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"MosaicLifeStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.219.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"MosaicLifeStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.219.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}