{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to Mosaic Life Documentation","text":"<p>Mosaic Life is a memorial stories platform that allows you to create, share, and preserve life stories and memories.</p>"},{"location":"#getting-started","title":"Getting Started","text":"<ul> <li>Installation - Set up your development environment</li> <li>First Steps - Create your first legacy</li> </ul>"},{"location":"#for-users","title":"For Users","text":"<ul> <li>Creating Stories - Write and edit stories</li> <li>Sharing Memories - Invite family and friends</li> </ul>"},{"location":"#for-developers","title":"For Developers","text":"<ul> <li>Local Setup - Run Mosaic Life locally</li> <li>Architecture - System design overview</li> <li>Contributing - How to contribute</li> </ul>"},{"location":"#api-reference","title":"API Reference","text":"<ul> <li>API Overview - REST API introduction</li> <li>OpenAPI Specification - Interactive API docs</li> </ul>"},{"location":"#code-reference","title":"Code Reference","text":"<ul> <li>Python API - Backend code documentation</li> <li>TypeScript API - Frontend code documentation</li> </ul>"},{"location":"changelog/","title":"Changelog","text":"<p>All notable changes to Mosaic Life are documented here.</p>"},{"location":"changelog/#unreleased","title":"[Unreleased]","text":""},{"location":"changelog/#added","title":"Added","text":"<ul> <li>Documentation site with versioned docs</li> <li>OpenAPI specification integration</li> <li>Auto-generated Python and TypeScript API references</li> </ul>"},{"location":"changelog/#changed","title":"Changed","text":"<ul> <li>N/A</li> </ul>"},{"location":"changelog/#fixed","title":"Fixed","text":"<ul> <li>N/A</li> </ul>"},{"location":"changelog/#version-history","title":"Version History","text":"<p>Versions are tagged in Git and correspond to documentation versions in the version selector above.</p>"},{"location":"api/openapi/","title":"OpenAPI Specification","text":"<p>Interactive API documentation powered by the OpenAPI specification.</p>"},{"location":"api/openapi/#swagger-ui","title":"Swagger UI","text":"<p>Interactive Documentation</p> <p>The embedded API documentation above allows you to explore endpoints, view request/response schemas, and test API calls directly.</p>"},{"location":"api/openapi/#download-specification","title":"Download Specification","text":"<p>The Mosaic Life API specification is available in JSON format:</p> <ul> <li>OpenAPI JSON - API specification</li> </ul>"},{"location":"api/openapi/#using-the-api","title":"Using the API","text":"<ol> <li>Authenticate via <code>/auth/login</code></li> <li>Use the session cookie for subsequent requests</li> <li>Explore endpoints in the documentation above</li> </ol>"},{"location":"api/overview/","title":"API Overview","text":"<p>The Mosaic Life API is a RESTful HTTP API built with FastAPI.</p>"},{"location":"api/overview/#base-url","title":"Base URL","text":"Environment URL Production <code>https://api.mosaiclife.me</code> Staging <code>https://stage-api.mosaiclife.me</code> Local <code>http://localhost:8080</code>"},{"location":"api/overview/#authentication","title":"Authentication","text":"<p>The API uses session-based authentication with Google OAuth.</p> <ol> <li>Initiate login: <code>GET /auth/login</code></li> <li>Complete OAuth flow</li> <li>Session cookie set automatically</li> </ol>"},{"location":"api/overview/#request-format","title":"Request Format","text":"<pre><code>curl -X GET https://api.mosaiclife.me/legacies \\\n  -H \"Content-Type: application/json\" \\\n  --cookie \"session=...\"\n</code></pre>"},{"location":"api/overview/#response-format","title":"Response Format","text":"<p>All responses follow this structure:</p> <pre><code>{\n  \"data\": { ... },\n  \"meta\": {\n    \"request_id\": \"abc123\"\n  }\n}\n</code></pre>"},{"location":"api/overview/#error-handling","title":"Error Handling","text":"<p>Errors return appropriate HTTP status codes:</p> Code Meaning 400 Bad Request - Invalid input 401 Unauthorized - Not logged in 403 Forbidden - Insufficient permissions 404 Not Found - Resource doesn't exist 500 Internal Error - Server issue"},{"location":"api/overview/#rate-limiting","title":"Rate Limiting","text":"<p>API requests are limited to 100 requests per minute per user.</p>"},{"location":"developer-guide/architecture/","title":"Architecture Overview","text":"<p>Mosaic Life uses a simplified MVP architecture designed for rapid development.</p>"},{"location":"developer-guide/architecture/#system-components","title":"System Components","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   React SPA     \u2502\u2500\u2500\u2500\u2500\u25b6\u2502   FastAPI       \u2502\n\u2502   (Vite)        \u2502     \u2502   (Core API)    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                 \u2502\n                        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                        \u2502   PostgreSQL    \u2502\n                        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"developer-guide/architecture/#tech-stack","title":"Tech Stack","text":""},{"location":"developer-guide/architecture/#frontend","title":"Frontend","text":"<ul> <li>React 18 + TypeScript</li> <li>Vite (build tool)</li> <li>TanStack Query (server state)</li> <li>React Router (routing)</li> </ul>"},{"location":"developer-guide/architecture/#backend","title":"Backend","text":"<ul> <li>FastAPI + Uvicorn</li> <li>SQLAlchemy 2.x + Alembic</li> <li>Pydantic v2 (validation)</li> <li>PostgreSQL 16</li> </ul>"},{"location":"developer-guide/architecture/#infrastructure","title":"Infrastructure","text":"<ul> <li>AWS EKS (Kubernetes)</li> <li>ArgoCD (GitOps)</li> <li>Helm (packaging)</li> <li>GitHub Actions (CI/CD)</li> </ul>"},{"location":"developer-guide/architecture/#key-patterns","title":"Key Patterns","text":"<ul> <li>Adapter Pattern: External integrations abstracted behind interfaces</li> <li>Repository Pattern: Data access through SQLAlchemy models</li> <li>OpenTelemetry: Distributed tracing and observability</li> </ul>"},{"location":"developer-guide/contributing/","title":"Contributing to Mosaic Life","text":"<p>We welcome contributions! This guide explains how to contribute effectively.</p>"},{"location":"developer-guide/contributing/#code-of-conduct","title":"Code of Conduct","text":"<p>Be respectful and inclusive. We're building something meaningful together.</p>"},{"location":"developer-guide/contributing/#development-workflow","title":"Development Workflow","text":"<ol> <li>Fork the repository</li> <li>Create a feature branch from <code>develop</code></li> <li>Make your changes</li> <li>Run tests and linting</li> <li>Submit a pull request</li> </ol>"},{"location":"developer-guide/contributing/#commit-messages","title":"Commit Messages","text":"<p>Use Conventional Commits format:</p> <pre><code>feat: add story search functionality\nfix: resolve date picker timezone issue\ndocs: update API authentication guide\nchore: upgrade dependencies\n</code></pre>"},{"location":"developer-guide/contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":"<ul> <li>Target &lt; 400 lines of code</li> <li>Include tests for new features</li> <li>Update documentation as needed</li> <li>Link to related GitHub issues</li> </ul>"},{"location":"developer-guide/contributing/#running-tests","title":"Running Tests","text":"<pre><code># Frontend\ncd apps/web\nnpm run test\n\n# Backend\ncd services/core-api\nuv run pytest\n</code></pre>"},{"location":"developer-guide/contributing/#code-style","title":"Code Style","text":"<ul> <li>TypeScript: ESLint + Prettier</li> <li>Python: Ruff + MyPy (strict)</li> </ul> <p>Always run <code>just validate-backend</code> before committing Python changes.</p>"},{"location":"developer-guide/environment-setup/","title":"Developer Environment Setup","text":"<p>This comprehensive guide covers everything you need to set up a complete development environment for the Mosaic Life platform, including multi-system configuration, AWS authentication, Kubernetes access, and CI/CD workflows.</p>"},{"location":"developer-guide/environment-setup/#architecture-overview","title":"Architecture Overview","text":"<p>The Mosaic Life development workflow uses a multi-repository, multi-system architecture:</p> <pre><code>graph TB\n    subgraph \"Windows Desktop\"\n        VS[\"VS Code + SSH Remote\"]\n        Browser[\"Browser (AWS SSO, ArgoCD UI)\"]\n        WinTools[\"AWS CLI, kubectl, gh\"]\n    end\n\n    subgraph \"Linux Development Server\"\n        Code[\"Repository Clones\"]\n        Docker[\"Docker + Compose\"]\n        Tools[\"AWS CLI, kubectl, argocd, gh, just\"]\n        AI[\"AI Coding Assistants\"]\n    end\n\n    subgraph \"GitHub\"\n        Repos[\"Repositories\"]\n        Actions[\"GitHub Actions\"]\n    end\n\n    subgraph \"AWS (us-east-1)\"\n        ECR[\"ECR\"]\n        EKS[\"EKS Cluster\"]\n        S3[\"S3 Buckets\"]\n        SecretsManager[\"Secrets Manager\"]\n    end\n\n    subgraph \"Kubernetes\"\n        ArgoCD[\"ArgoCD\"]\n        Apps[\"Application Pods\"]\n    end\n\n    VS --&gt;|SSH| Code\n    Browser --&gt;|HTTPS| ArgoCD\n    Code --&gt; Docker\n    Tools --&gt; EKS\n    Actions --&gt; ECR\n    Actions --&gt; Repos\n    ECR --&gt; ArgoCD\n    ArgoCD --&gt; Apps</code></pre>"},{"location":"developer-guide/environment-setup/#repository-structure","title":"Repository Structure","text":"<p>Clone the following repositories under <code>/apps</code>:</p> Repository Local Path Purpose mosaic-stories/mosaic-life <code>/apps/mosaic-life</code> Main application (web, API, docs) mosaic-stories/infrastructure <code>/apps/mosaic-life-infrastructure</code> AWS/EKS infrastructure (CDK, eksctl) mosaic-stories/gitops <code>/apps/mosaic-life-gitops</code> Deployment configurations"},{"location":"developer-guide/environment-setup/#system-requirements","title":"System Requirements","text":""},{"location":"developer-guide/environment-setup/#linux-development-server-ubuntu","title":"Linux Development Server (Ubuntu)","text":"<p>This is your primary development environment, accessed via VS Code SSH Remote.</p>"},{"location":"developer-guide/environment-setup/#required-tools","title":"Required Tools","text":"Tool Installation Purpose Docker <code>sudo apt install docker.io</code> Container runtime Docker Compose <code>sudo apt install docker-compose-plugin</code> Local orchestration AWS CLI v2 AWS CLI Install Guide AWS authentication kubectl <code>sudo snap install kubectl --classic</code> Kubernetes CLI eksctl eksctl Installation EKS cluster management ArgoCD CLI ArgoCD CLI Install GitOps deployments GitHub CLI <code>sudo apt install gh</code> GitHub operations Git <code>sudo apt install git</code> Version control just <code>cargo install just</code> or Pre-built binaries Task runner Node.js 20+ NodeSource Frontend development Python 3.12+ <code>sudo apt install python3.12</code> Backend development uv <code>curl -LsSf https://astral.sh/uv/install.sh \\| sh</code> Python package manager jq <code>sudo apt install jq</code> JSON processing yq <code>sudo snap install yq</code> YAML processing ripgrep <code>sudo apt install ripgrep</code> Fast search"},{"location":"developer-guide/environment-setup/#docker-post-installation","title":"Docker Post-Installation","text":"<pre><code># Add your user to the docker group\nsudo usermod -aG docker $USER\n\n# Log out and back in, then verify\ndocker run hello-world\n</code></pre>"},{"location":"developer-guide/environment-setup/#windows-desktop","title":"Windows Desktop","text":"<p>This is your IDE and browser access point.</p>"},{"location":"developer-guide/environment-setup/#required-tools_1","title":"Required Tools","text":"Tool Installation Purpose VS Code Download IDE VS Code Remote - SSH Extension marketplace Connect to Linux server AWS CLI v2 MSI Installer AWS SSO authentication kubectl <code>winget install Kubernetes.kubectl</code> Kubernetes CLI (port-forward) Git Git for Windows Version control"},{"location":"developer-guide/environment-setup/#vs-code-extensions-recommended","title":"VS Code Extensions (Recommended)","text":"<ul> <li>Remote - SSH</li> <li>Docker</li> <li>GitLens</li> <li>Python</li> <li>ESLint</li> <li>Prettier</li> <li>YAML</li> </ul>"},{"location":"developer-guide/environment-setup/#repository-setup","title":"Repository Setup","text":""},{"location":"developer-guide/environment-setup/#clone-repositories-linux","title":"Clone Repositories (Linux)","text":"<pre><code># Create apps directory\nmkdir -p /apps\ncd /apps\n\n# Clone main application\ngit clone https://github.com/mosaic-stories/mosaic-life.git\ncd mosaic-life\ngit checkout develop  # Development branch\ncd ..\n\n# Clone infrastructure\ngit clone https://github.com/mosaic-stories/infrastructure.git mosaic-life-infrastructure\ncd mosaic-life-infrastructure\ngit checkout main\ncd ..\n\n# Clone GitOps\ngit clone https://github.com/mosaic-stories/gitops.git mosaic-life-gitops\ncd mosaic-life-gitops\ngit checkout main\ncd ..\n</code></pre>"},{"location":"developer-guide/environment-setup/#github-cli-authentication","title":"GitHub CLI Authentication","text":"<pre><code># Authenticate with GitHub\ngh auth login\n\n# Select:\n# - GitHub.com\n# - HTTPS\n# - Login with a web browser\n\n# Verify authentication\ngh auth status\n</code></pre>"},{"location":"developer-guide/environment-setup/#aws-authentication","title":"AWS Authentication","text":""},{"location":"developer-guide/environment-setup/#aws-sso-setup-recommended-for-windows","title":"AWS SSO Setup (Recommended for Windows)","text":"<p>On your Windows desktop, configure AWS SSO for automatic credential refresh:</p> <pre><code># Configure SSO profile\naws configure sso\n# SSO session name: mosaiclife\n# SSO start URL: https://d-9067ae6582.awsapps.com/start\n# SSO region: us-east-1\n# SSO registration scopes: sso:account:access\n\n# Login (opens browser)\naws sso login --profile mosaiclife\n\n# Set as default\n$env:AWS_PROFILE = \"mosaiclife\"\n</code></pre>"},{"location":"developer-guide/environment-setup/#manual-credentials-linux","title":"Manual Credentials (Linux)","text":"<p>For the Linux development server, manually update credentials from AWS SSO portal:</p> <ol> <li>Open browser: https://d-9067ae6582.awsapps.com/start/#/?tab=accounts</li> <li>Select MosaicLife account</li> <li>Click Access Keys next to AdministratorAccess</li> <li>Copy the credentials</li> </ol> <pre><code># Update credentials file\naws configure\n\n# When prompted:\n# AWS Access Key ID: &lt;paste from SSO portal&gt;\n# AWS Secret Access Key: &lt;paste from SSO portal&gt;\n# Default region name: us-east-1\n# Default output format: json\n\n# For session token (temporary credentials)\nnano ~/.aws/credentials\n# Add under [default]:\n# aws_session_token = &lt;paste session token&gt;\n</code></pre> <p>Alternatively, use the quick export method:</p> <pre><code># Copy the \"Option 1: Set AWS environment variables\" from SSO portal\nexport AWS_ACCESS_KEY_ID=\"...\"\nexport AWS_SECRET_ACCESS_KEY=\"...\"\nexport AWS_SESSION_TOKEN=\"...\"\n</code></pre> <p>Session Expiration</p> <p>AWS SSO credentials expire after 12 hours. You'll need to refresh them at the start of each coding session.</p>"},{"location":"developer-guide/environment-setup/#verify-aws-access","title":"Verify AWS Access","text":"<pre><code># Check identity\naws sts get-caller-identity\n\n# Expected output:\n# {\n#     \"UserId\": \"...\",\n#     \"Account\": \"033691785857\",\n#     \"Arn\": \"arn:aws:sts::033691785857:assumed-role/AWSReservedSSO_AdministratorAccess_...\"\n# }\n</code></pre>"},{"location":"developer-guide/environment-setup/#kubernetes-configuration","title":"Kubernetes Configuration","text":""},{"location":"developer-guide/environment-setup/#configure-kubectl","title":"Configure kubectl","text":"<pre><code># Update kubeconfig for EKS cluster\naws eks update-kubeconfig --region us-east-1 --name mosaiclife-eks\n\n# Verify connection\nkubectl get nodes\n\n# Expected output:\n# NAME                          STATUS   ROLES    AGE   VERSION\n# ip-10-20-xxx-xxx.ec2.internal Ready    &lt;none&gt;   ...   v1.33.x\n</code></pre>"},{"location":"developer-guide/environment-setup/#using-just-commands","title":"Using just Commands","text":"<p>The <code>/apps/mosaic-life/justfile</code> provides shortcuts:</p> <pre><code>cd /apps/mosaic-life\n\n# Update kubeconfig\njust kubeconfig\n\n# View cluster info\njust cluster-info\n\n# List pods in application namespace\njust pods\n</code></pre>"},{"location":"developer-guide/environment-setup/#argocd-access","title":"ArgoCD Access","text":"<p>ArgoCD is not exposed publicly. Access it via port-forwarding.</p>"},{"location":"developer-guide/environment-setup/#port-forward-setup","title":"Port Forward Setup","text":"Linux (CLI Access)Windows (UI Access) <pre><code>cd /apps/mosaic-life\n\n# Start port-forward (runs in foreground)\njust argocd-ui\n# Or manually:\nkubectl port-forward svc/argocd-server -n argocd 8085:443\n\n# Get admin password\njust argocd-password\n\n# Login via CLI\njust argocd-login\n</code></pre> <pre><code># Start port-forward\nkubectl port-forward svc/argocd-server -n argocd 8085:443\n\n# Open browser: http://localhost:8085\n# Username: admin\n# Password: (get from Linux using just argocd-password)\n</code></pre>"},{"location":"developer-guide/environment-setup/#dual-access-pattern","title":"Dual Access Pattern","text":"<p>For effective development:</p> <ol> <li>Linux terminal: Run <code>just argocd-ui</code> for CLI access</li> <li>Windows browser: Port-forward and access <code>http://localhost:8085</code> for visual monitoring</li> </ol> <pre><code># On Linux - Get password for Windows browser login\njust argocd-password\n</code></pre>"},{"location":"developer-guide/environment-setup/#common-argocd-commands","title":"Common ArgoCD Commands","text":"<pre><code>cd /apps/mosaic-life\n\n# List applications\njust argocd-list\n\n# Check application status\njust argocd-status mosaic-life-staging\n\n# Sync (deploy) application\njust argocd-sync mosaic-life-staging\n\n# Watch sync progress\njust argocd-watch mosaic-life-staging\n\n# View diff before sync\njust argocd-diff mosaic-life-staging\n</code></pre>"},{"location":"developer-guide/environment-setup/#local-development","title":"Local Development","text":""},{"location":"developer-guide/environment-setup/#quick-start","title":"Quick Start","text":"<pre><code>cd /apps/mosaic-life\n\n# Full setup (start services, run migrations, seed data)\njust setup\n\n# Or step by step:\njust dev-up              # Start Docker Compose stack\njust db-migrate          # Run database migrations\njust seed                # Add sample data\n</code></pre>"},{"location":"developer-guide/environment-setup/#service-urls","title":"Service URLs","text":"Service URL Purpose Frontend (dev) http://localhost:5173 Vite dev server with HMR Backend API http://localhost:8080 FastAPI backend PostgreSQL localhost:15432 Database (user: postgres, db: core) Documentation http://localhost:8000 MkDocs (with <code>--profile docs</code>) Jaeger http://localhost:16686 Distributed tracing OpenSearch http://localhost:9200 Search engine"},{"location":"developer-guide/environment-setup/#development-workflows","title":"Development Workflows","text":"Frontend OnlyBackend OnlyFull StackDocumentation <pre><code>cd /apps/mosaic-life/apps/web\nnpm install\nnpm run dev\n</code></pre> <pre><code>cd /apps/mosaic-life/services/core-api\nuv sync\nuv run alembic upgrade head\nuv run python -m app.main\n</code></pre> <pre><code>cd /apps/mosaic-life\njust dev-up     # Start all services\njust logs       # Tail logs\n</code></pre> <pre><code>cd /apps/mosaic-life\njust docs-serve   # Serve locally at :8000\n</code></pre>"},{"location":"developer-guide/environment-setup/#database-operations","title":"Database Operations","text":"<pre><code>cd /apps/mosaic-life\n\n# Access PostgreSQL shell\njust db-shell\n\n# Or directly:\ndocker compose -f infra/compose/docker-compose.yml exec postgres psql -U postgres -d core\n\n# Run migrations\njust db-migrate\n\n# Create new migration\ncd services/core-api\nuv run alembic revision --autogenerate -m \"add_new_table\"\n</code></pre>"},{"location":"developer-guide/environment-setup/#cicd-workflow","title":"CI/CD Workflow","text":""},{"location":"developer-guide/environment-setup/#branch-strategy","title":"Branch Strategy","text":"Branch Environment Domain Auto-Deploy <code>develop</code> Staging stage.mosaiclife.me Yes <code>main</code> Production mosaiclife.me Yes <code>feature/*</code> Preview pr-{n}.mosaiclife.me On PR"},{"location":"developer-guide/environment-setup/#deployment-flow","title":"Deployment Flow","text":"<pre><code>sequenceDiagram\n    participant Dev as Developer\n    participant GH as GitHub\n    participant GA as GitHub Actions\n    participant ECR as AWS ECR\n    participant GitOps as GitOps Repo\n    participant Argo as ArgoCD\n    participant K8s as Kubernetes\n\n    Dev-&gt;&gt;GH: Push to develop\n    GH-&gt;&gt;GA: Trigger workflow\n    GA-&gt;&gt;GA: Build &amp; Test\n    GA-&gt;&gt;ECR: Push Docker images\n    GA-&gt;&gt;GitOps: Update image tags\n    GitOps-&gt;&gt;Argo: Detect changes\n    Argo-&gt;&gt;K8s: Deploy new version\n    K8s--&gt;&gt;Dev: Staging available</code></pre>"},{"location":"developer-guide/environment-setup/#monitoring-cicd","title":"Monitoring CI/CD","text":""},{"location":"developer-guide/environment-setup/#github-actions","title":"GitHub Actions","text":"<pre><code># List recent workflow runs\ngh run list --repo mosaic-stories/mosaic-life\n\n# View specific run\ngh run view &lt;run-id&gt;\n\n# Watch running workflow\ngh run watch &lt;run-id&gt;\n\n# View logs for failed job\ngh run view &lt;run-id&gt; --log-failed\n</code></pre>"},{"location":"developer-guide/environment-setup/#argocd-status","title":"ArgoCD Status","text":"<pre><code>cd /apps/mosaic-life\n\n# Check all applications\njust argocd-list\n\n# Detailed status\njust argocd-status mosaic-life-staging\n\n# Watch sync progress\njust argocd-watch mosaic-life-staging\n</code></pre>"},{"location":"developer-guide/environment-setup/#troubleshooting-deployments","title":"Troubleshooting Deployments","text":"<pre><code># View pod status\njust pods\n\n# Tail application logs\njust logs core-api\njust logs web\n\n# Describe failing pod\nkubectl describe pod -n mosaiclife &lt;pod-name&gt;\n\n# Get events\nkubectl get events -n mosaiclife --sort-by='.lastTimestamp'\n\n# Execute into pod\njust exec core-api bash\n</code></pre>"},{"location":"developer-guide/environment-setup/#environment-domains","title":"Environment Domains","text":""},{"location":"developer-guide/environment-setup/#production","title":"Production","text":"Service URL Web Application https://mosaiclife.me API https://api.mosaiclife.me Documentation https://docs.mosaiclife.me"},{"location":"developer-guide/environment-setup/#staging","title":"Staging","text":"Service URL Web Application https://stage.mosaiclife.me API https://stage-api.mosaiclife.me Documentation https://stage-docs.mosaiclife.me"},{"location":"developer-guide/environment-setup/#preview-environments","title":"Preview Environments","text":"<p>Preview environments are created automatically for pull requests:</p> <ul> <li>Web: <code>https://pr-{number}.mosaiclife.me</code></li> <li>API: <code>https://pr-{number}-api.mosaiclife.me</code></li> </ul> <p>Preview Environment Status</p> <p>Preview environments are currently in development. Some workflow issues are being debugged.</p>"},{"location":"developer-guide/environment-setup/#code-quality-validation","title":"Code Quality &amp; Validation","text":""},{"location":"developer-guide/environment-setup/#before-committing","title":"Before Committing","text":"<pre><code>cd /apps/mosaic-life\n\n# Validate everything\njust validate-all\n\n# Or separately:\njust validate-backend    # Ruff + MyPy\njust validate-frontend   # ESLint + TypeScript\n\n# Auto-fix issues\njust lint-fix-backend\n</code></pre>"},{"location":"developer-guide/environment-setup/#backend-validation","title":"Backend Validation","text":"<pre><code>cd /apps/mosaic-life/services/core-api\n\n# Linting\nuv run ruff check .\n\n# Type checking\nuv run mypy app\n\n# Format check\nuv run ruff format --check .\n\n# Auto-fix\nuv run ruff check --fix .\nuv run ruff format .\n</code></pre>"},{"location":"developer-guide/environment-setup/#frontend-validation","title":"Frontend Validation","text":"<pre><code>cd /apps/mosaic-life/apps/web\n\n# Lint\nnpm run lint\n\n# Type check\nnpm run typecheck\n\n# Test\nnpm run test\n</code></pre>"},{"location":"developer-guide/environment-setup/#typical-development-session","title":"Typical Development Session","text":""},{"location":"developer-guide/environment-setup/#start-of-session","title":"Start of Session","text":"<pre><code># 1. Refresh AWS credentials (from browser SSO portal)\n# Navigate to: https://d-9067ae6582.awsapps.com/start/#/?tab=accounts\n# Copy credentials and update ~/.aws/credentials\n\n# 2. Verify AWS access\naws sts get-caller-identity\n\n# 3. Update kubeconfig\njust kubeconfig\n\n# 4. Start port-forwards for ArgoCD (optional)\njust argocd-ui &amp;  # Background on Linux\n# Also start on Windows for UI access\n\n# 5. Start local development stack\njust dev-up\n\n# 6. Pull latest changes\ngit pull origin develop\n</code></pre>"},{"location":"developer-guide/environment-setup/#during-development","title":"During Development","text":"<pre><code># Make changes...\n\n# Validate before commit\njust validate-all\n\n# Commit with conventional format\ngit add .\ngit commit -m \"feat: add user profile editing\"\n\n# Push to trigger CI/CD\ngit push origin develop\n</code></pre>"},{"location":"developer-guide/environment-setup/#monitoring-deployment","title":"Monitoring Deployment","text":"<pre><code># Watch GitHub Actions\ngh run watch\n\n# Once Actions complete, watch ArgoCD\njust argocd-watch mosaic-life-staging\n\n# Verify deployment\nkubectl get pods -n mosaiclife\njust logs core-api\n</code></pre>"},{"location":"developer-guide/environment-setup/#end-of-session","title":"End of Session","text":"<pre><code># Stop local services\njust dev-down\n\n# Or keep running for background testing\n</code></pre>"},{"location":"developer-guide/environment-setup/#quick-reference","title":"Quick Reference","text":""},{"location":"developer-guide/environment-setup/#just-commands","title":"Just Commands","text":"Command Description <code>just setup</code> Full local setup <code>just dev-up</code> Start Docker Compose <code>just dev-down</code> Stop Docker Compose <code>just logs [service]</code> Tail logs <code>just pods</code> List Kubernetes pods <code>just validate-all</code> Run all validations <code>just argocd-ui</code> Port-forward to ArgoCD <code>just argocd-password</code> Get admin password <code>just argocd-status [app]</code> Check app status <code>just argocd-sync [app]</code> Trigger deployment"},{"location":"developer-guide/environment-setup/#useful-aliases","title":"Useful Aliases","text":"<p>Add to your <code>~/.bashrc</code> or <code>~/.zshrc</code>:</p> <pre><code># Quick navigation\nalias ml='cd /apps/mosaic-life'\nalias mli='cd /apps/mosaic-life-infrastructure'\nalias mlg='cd /apps/mosaic-life-gitops'\n\n# Kubernetes shortcuts\nalias k='kubectl'\nalias kgp='kubectl get pods -n mosaiclife'\nalias kgs='kubectl get svc -n mosaiclife'\nalias kl='kubectl logs -n mosaiclife'\n\n# Docker shortcuts\nalias dc='docker compose -f /apps/mosaic-life/infra/compose/docker-compose.yml'\n</code></pre>"},{"location":"developer-guide/environment-setup/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/environment-setup/#aws-credentials-expired","title":"AWS Credentials Expired","text":"<pre><code># Error: ExpiredToken\n# Solution: Refresh from SSO portal\n# https://d-9067ae6582.awsapps.com/start/#/?tab=accounts\n</code></pre>"},{"location":"developer-guide/environment-setup/#kubectl-connection-refused","title":"kubectl Connection Refused","text":"<pre><code># Error: Unable to connect to the server\n# Solution: Update kubeconfig\naws eks update-kubeconfig --region us-east-1 --name mosaiclife-eks\n</code></pre>"},{"location":"developer-guide/environment-setup/#argocd-connection-failed","title":"ArgoCD Connection Failed","text":"<pre><code># Error: dial tcp 127.0.0.1:8085: connect: connection refused\n# Solution: Start port-forward\nkubectl port-forward svc/argocd-server -n argocd 8085:443\n</code></pre>"},{"location":"developer-guide/environment-setup/#docker-compose-issues","title":"Docker Compose Issues","text":"<pre><code># Reset everything\ndocker compose -f infra/compose/docker-compose.yml down\ndocker volume prune -f\ndocker compose -f infra/compose/docker-compose.yml up -d\n</code></pre>"},{"location":"developer-guide/environment-setup/#database-migration-conflicts","title":"Database Migration Conflicts","text":"<pre><code>cd /apps/mosaic-life/services/core-api\n\n# Check current revision\nuv run alembic current\n\n# View history\nuv run alembic history\n\n# Rollback one step\nuv run alembic downgrade -1\n\n# Reset to base\nuv run alembic downgrade base\nuv run alembic upgrade head\n</code></pre>"},{"location":"developer-guide/environment-setup/#related-documentation","title":"Related Documentation","text":"<ul> <li>Local Development Setup - Basic local setup</li> <li>Architecture Overview - System architecture</li> <li>Contributing Guide - Contribution guidelines</li> <li>API Reference - API documentation</li> </ul>"},{"location":"developer-guide/graph-augmented-rag/","title":"Graph-Augmented RAG Architecture","text":"<p>The Graph-Augmented RAG system enhances AI persona conversations by combining pgvector embedding search with Neptune graph traversals. Instead of relying solely on vector similarity to find relevant story context, the system also traverses a knowledge graph of people, places, events, and objects extracted from stories \u2014 producing richer, more connected context for persona responses.</p> <p>For the full design rationale, see the design document.</p>"},{"location":"developer-guide/graph-augmented-rag/#processing-pipeline","title":"Processing Pipeline","text":"<pre><code>sequenceDiagram\n    participant PT as prepare_turn()\n    participant GCS as GraphContextService\n    participant IA as IntentAnalyzer\n    participant VS as VectorStore\n    participant GTS as GraphTraversalService\n    participant GAF as GraphAccessFilter\n    participant CB as CircuitBreaker\n\n    PT-&gt;&gt;GCS: assemble_context(query, legacy_id, ...)\n\n    par Parallel Execution\n        GCS-&gt;&gt;IA: analyze(query, legacy_name)\n        IA--&gt;&gt;GCS: QueryIntent\n    and\n        GCS-&gt;&gt;VS: retrieve_context(query, ...)\n        VS--&gt;&gt;GCS: ChunkResult[]\n    end\n\n    GCS-&gt;&gt;CB: allow_request()\n    alt Circuit Closed\n        CB--&gt;&gt;GCS: true\n        GCS-&gt;&gt;GTS: traverse(intent, person_id, ...)\n        GTS--&gt;&gt;GCS: GraphResult[]\n        GCS-&gt;&gt;GAF: filter_story_ids(results, user_id, ...)\n        GAF--&gt;&gt;GCS: filtered results\n    else Circuit Open\n        CB--&gt;&gt;GCS: false\n        Note over GCS: Skip graph, use embeddings only\n    end\n\n    GCS-&gt;&gt;GCS: merge + rank + deduplicate\n    GCS-&gt;&gt;GCS: token budget + format\n    GCS--&gt;&gt;PT: AssembledContext</code></pre> <p>Pipeline steps:</p> <ol> <li> <p>Intent Analysis + Embedding Search (parallel, ~200-400ms) \u2014 An LLM classifier identifies the query type (relational, temporal, spatial, entity-focused, general, or cross-legacy) and extracts mentioned entities. Simultaneously, pgvector retrieves embedding-similar story chunks.</p> </li> <li> <p>Graph Traversal (~100-200ms) \u2014 Based on the classified intent, parameterized graph queries find connected stories through the knowledge graph. The persona's traversal configuration controls relationship weights, hop depth, and cross-legacy inclusion.</p> </li> <li> <p>Access Filtering (~10ms) \u2014 Graph results are filtered against the user's visibility permissions using the same access rules as direct story queries.</p> </li> <li> <p>Merge + Rank + Deduplicate (~5ms) \u2014 Embedding results and graph results are merged, scored, and deduplicated. Graph results get a boost based on hop distance and relationship weight.</p> </li> <li> <p>Token Budget + Format (~5ms) \u2014 Results are trimmed to fit within the token budget (default 4000 tokens) and formatted for LLM prompt insertion.</p> </li> </ol>"},{"location":"developer-guide/graph-augmented-rag/#key-services","title":"Key Services","text":"Service File Purpose <code>GraphContextService</code> <code>app/services/graph_context.py</code> Orchestrates the full pipeline: parallel intent+embedding, graph traversal, filtering, ranking, formatting <code>IntentAnalyzer</code> <code>app/services/intent_analyzer.py</code> LLM-based query classifier \u2014 identifies intent type and extracts entities <code>GraphTraversalService</code> <code>app/services/graph_traversal.py</code> Maps <code>(QueryIntent, TraversalConfig)</code> to parameterized graph queries <code>GraphAccessFilter</code> <code>app/services/graph_context.py</code> Filters graph-discovered story IDs against user visibility permissions <code>EntityExtractionService</code> <code>app/services/entity_extraction.py</code> Extracts people, places, events, objects from story content at ingestion time <code>CircuitBreaker</code> <code>app/services/circuit_breaker.py</code> Three-state fault tolerance for Neptune connectivity"},{"location":"developer-guide/graph-augmented-rag/#intent-types","title":"Intent Types","text":"<p>The <code>IntentAnalyzer</code> classifies queries into one of six intent types, each triggering different graph traversal strategies:</p> Intent Example Query Graph Strategy <code>relational</code> \"Tell me about Jim's family\" Traverse FAMILY_OF, KNEW edges from mentioned person <code>temporal</code> \"What happened in the 1980s?\" Filter by time period properties on story nodes <code>spatial</code> \"Stories about Chicago\" Traverse TOOK_PLACE_AT edges to place nodes <code>entity_focused</code> \"Tell me more about the cabin\" Direct lookup of entity node + connected stories <code>general</code> \"What else can you tell me?\" Broad traversal from current story context <code>cross_legacy</code> \"Did grandma know Uncle Jim?\" Cross-legacy traversal through shared connections"},{"location":"developer-guide/graph-augmented-rag/#graph-adapters","title":"Graph Adapters","text":"<pre><code>classDiagram\n    class GraphAdapter {\n        &lt;&lt;abstract&gt;&gt;\n        +upsert_node(label, node_id, properties)\n        +delete_node(label, node_id)\n        +create_relationship(from_label, from_id, rel_type, to_label, to_id)\n        +delete_relationship(from_label, from_id, rel_type, to_label, to_id)\n        +get_connections(label, node_id, rel_types, depth)\n        +find_path(from_id, to_id, max_depth)\n        +get_related_stories(story_id, limit)\n        +query(query_str, params)\n        +health_check()\n    }\n    class LocalGraphAdapter {\n        -host: str\n        -port: int\n        -env_prefix: str\n        +_execute_gremlin(gremlin)\n    }\n    class NeptuneGraphAdapter {\n        -host: str\n        -port: int\n        -region: str\n        -iam_auth: bool\n        -env_prefix: str\n        +_execute_cypher(cypher, params)\n        +_sign_request(headers)\n    }\n    GraphAdapter &lt;|-- LocalGraphAdapter : Gremlin REST API\n    GraphAdapter &lt;|-- NeptuneGraphAdapter : openCypher HTTPS</code></pre> <ul> <li><code>LocalGraphAdapter</code> \u2014 Uses TinkerPop Gremlin Server's REST API (<code>POST /gremlin</code>). For local development only.</li> <li><code>NeptuneGraphAdapter</code> \u2014 Uses AWS Neptune's openCypher HTTPS endpoint with optional IAM SigV4 signing.</li> <li><code>create_graph_adapter()</code> factory in <code>app/adapters/graph_factory.py</code> selects the adapter based on configuration: Neptune when <code>NEPTUNE_HOST</code> is set, local TinkerPop otherwise. Returns <code>None</code> when graph augmentation is disabled.</li> </ul>"},{"location":"developer-guide/graph-augmented-rag/#environment-prefix-isolation","title":"Environment Prefix Isolation","text":"<p>All labels and relationship types are prefixed with the environment name (e.g., <code>prod-Person</code>, <code>staging-FAMILY_OF</code>). This allows multiple environments to share a single Neptune cluster. The prefix is injected transparently by the adapter \u2014 callers always use unprefixed logical names.</p>"},{"location":"developer-guide/graph-augmented-rag/#persona-traversal-configuration","title":"Persona Traversal Configuration","text":"<p>Each persona has a <code>TraversalConfig</code> in <code>app/config/personas.yaml</code> that shapes how graph queries are constructed:</p> Setting Biographer Friend Colleague Family <code>max_hops</code> 2 1 1 2 <code>FAMILY_OF</code> weight 1.0 0.5 0.2 1.0 <code>KNEW</code> weight 0.8 1.0 0.6 0.3 <code>WORKED_WITH</code> weight 0.7 0.4 1.0 0.2 <code>FRIENDS_WITH</code> weight 0.8 1.0 0.5 0.4 <code>max_graph_results</code> 20 15 15 20 <code>include_cross_legacy</code> true true false true <code>temporal_range</code> full recent career full <p>These weights multiply with hop distance factors to produce a final relevance score:</p> <pre><code>relevance_score = hop_factor * relationship_weight + entity_match_bonus\n</code></pre> <p>Where <code>hop_factor</code> is <code>1.0</code> for 1-hop, <code>0.6</code> for 2-hop, and <code>0.3</code> beyond that. The <code>entity_match_bonus</code> of <code>0.2</code> is added when the traversed entity matches one extracted from the user's query.</p>"},{"location":"developer-guide/graph-augmented-rag/#circuit-breaker","title":"Circuit Breaker","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Closed\n    Closed --&gt; Open : 3 consecutive failures\n    Open --&gt; HalfOpen : 30s recovery timeout\n    HalfOpen --&gt; Closed : success\n    HalfOpen --&gt; Open : failure\n    Closed --&gt; Closed : success (reset counter)</code></pre> <p>The circuit breaker wraps all Neptune/graph operations. When Neptune is unavailable:</p> <ul> <li>After 3 consecutive failures, the circuit opens and all graph operations are skipped.</li> <li>The system falls back to embedding-only RAG (the pre-graph behavior) with no user-visible degradation beyond slightly less connected suggestions.</li> <li>After 30 seconds, the circuit transitions to half-open and allows one trial request.</li> <li>A successful trial closes the circuit and restores full graph-augmented behavior.</li> </ul>"},{"location":"developer-guide/graph-augmented-rag/#entity-extraction-pipeline","title":"Entity Extraction Pipeline","text":"<pre><code>flowchart LR\n    A[Story Ingested] --&gt; B[LLM Extraction]\n    B --&gt; C[Confidence Filtering]\n    C --&gt; D{Confidence &gt;= 0.7?}\n    D --&gt;|Yes| E[Sync to Graph]\n    D --&gt;|No| F[Discard]\n    E --&gt; G[Places]\n    E --&gt; H[Events]\n    E --&gt; I[Objects]\n\n    style A fill:#e1f5fe\n    style E fill:#c8e6c9\n    style F fill:#ffcdd2</code></pre> <p>Entity extraction runs as a best-effort step during story ingestion. An LLM extracts people, places, events, objects, and time references from story content. Entities with confidence &gt;= 0.7 are synced to the graph database as nodes with relationships to the story node.</p> <p>For existing stories, the <code>scripts/backfill_entities.py</code> script processes all stories and populates the graph. A Kubernetes Job manifest is available for production backfill.</p>"},{"location":"developer-guide/graph-augmented-rag/#story-evolution-integration","title":"Story Evolution Integration","text":"<p>Graph context enriches the story evolution pipeline at two points:</p> <ol> <li> <p>Opening message \u2014 When a user starts a conversation to evolve a story, <code>GraphContextService</code> is called with the story's content to discover connections. These are included in the system prompt so the persona can suggest graph-discovered exploration directions.</p> </li> <li> <p>Pre-summarization \u2014 Before summarizing the conversation into story updates, a graph traversal discovers additional context from entities mentioned during the conversation. This is appended as \"Additional Context from Connected Stories\" to help the summarizer produce richer updates.</p> </li> </ol>"},{"location":"developer-guide/graph-augmented-rag/#observability","title":"Observability","text":""},{"location":"developer-guide/graph-augmented-rag/#opentelemetry-spans","title":"OpenTelemetry Spans","text":"<p>All services emit OTel spans under the <code>core-api.*</code> tracer namespace:</p> <ul> <li><code>graph_context.assemble</code> \u2014 Full pipeline span with attributes for intent, result counts, latency</li> <li><code>intent_analyzer.analyze</code> \u2014 Intent classification span</li> <li><code>graph_traversal.traverse</code> \u2014 Graph query span</li> <li><code>entity_extraction.extract</code> \u2014 Entity extraction span</li> </ul>"},{"location":"developer-guide/graph-augmented-rag/#prometheus-metrics","title":"Prometheus Metrics","text":"Metric Type Labels Description <code>core_api_graph_context_latency_seconds</code> Histogram <code>phase</code> (total, graph) Context assembly latency <code>core_api_graph_context_results_total</code> Counter <code>source</code> (embedding, graph) Results by source <code>core_api_graph_context_circuit_state</code> Gauge <code>state</code> Circuit breaker state (0=closed, 1=open, 2=half_open) <code>core_api_entity_extraction_entities_total</code> Counter <code>type</code> (person, place, event, object) Extracted entities <code>core_api_neptune_query_latency_seconds</code> Histogram <code>query_type</code> (gremlin, cypher) Neptune query latency"},{"location":"developer-guide/graph-augmented-rag/#debug-mode","title":"Debug Mode","text":"<p>Add <code>?debug=true</code> to persona chat endpoints to include <code>AssembledContext.metadata</code> in the response. This exposes intent classification, result counts, latency breakdown, and circuit breaker state for troubleshooting.</p>"},{"location":"developer-guide/graph-augmented-rag/#further-reading","title":"Further Reading","text":"<ul> <li>Design Document \u2014 Full design rationale, query templates, token budgeting details</li> <li>Implementation Plan \u2014 Phase-by-phase implementation with 24 tasks</li> <li>Graph RAG Configuration \u2014 Environment variables, persona tuning, operations guide</li> </ul>"},{"location":"developer-guide/graph-rag-configuration/","title":"Graph RAG Configuration &amp; Operations","text":"<p>This page covers environment variables, Neptune setup, persona tuning, and operational tasks for the graph-augmented RAG system. For architecture details, see Graph-Augmented RAG Architecture.</p>"},{"location":"developer-guide/graph-rag-configuration/#environment-variables","title":"Environment Variables","text":"Variable Default Description <code>GRAPH_AUGMENTATION_ENABLED</code> <code>true</code> Master toggle. Set to <code>false</code> to disable all graph features and fall back to embedding-only RAG. <code>NEPTUNE_HOST</code> (none) Neptune cluster endpoint. When unset, the system uses a local TinkerPop Gremlin Server. <code>NEPTUNE_PORT</code> <code>8182</code> Neptune/Gremlin Server port. <code>NEPTUNE_REGION</code> <code>us-east-1</code> AWS region for Neptune IAM authentication. <code>NEPTUNE_IAM_AUTH</code> <code>false</code> Enable IAM SigV4 request signing for Neptune. Required in production. <code>NEPTUNE_ENV_PREFIX</code> <code>local</code> Environment prefix for label isolation (e.g., <code>prod</code>, <code>staging</code>). All graph labels are prefixed: <code>prod-Person</code>, <code>staging-FAMILY_OF</code>. <code>INTENT_ANALYSIS_MODEL_ID</code> <code>us.anthropic.claude-haiku-4-5-20251001-v1:0</code> Bedrock model for query intent classification. Use a lightweight model for speed. <code>ENTITY_EXTRACTION_MODEL_ID</code> <code>us.anthropic.claude-haiku-4-5-20251001-v1:0</code> Bedrock model for entity extraction during story ingestion."},{"location":"developer-guide/graph-rag-configuration/#local-development-setup","title":"Local Development Setup","text":""},{"location":"developer-guide/graph-rag-configuration/#starting-neptune-tinkerpop","title":"Starting Neptune (TinkerPop)","text":"<p>The local development stack uses TinkerPop Gremlin Server as a Neptune stand-in:</p> <pre><code># Start the graph database\ndocker compose -f infra/compose/docker-compose.yml up -d neptune-local\n\n# Verify it's running\ncurl http://localhost:18182\n</code></pre>"},{"location":"developer-guide/graph-rag-configuration/#testing-connectivity","title":"Testing Connectivity","text":"<pre><code># Submit a basic Gremlin query\ncurl -X POST http://localhost:18182/gremlin \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"gremlin\": \"g.V().count()\"}'\n\n# Expected response:\n# {\"requestId\":\"...\",\"status\":{\"code\":200},\"result\":{\"data\":[0]}}\n</code></pre>"},{"location":"developer-guide/graph-rag-configuration/#local-environment-variables","title":"Local Environment Variables","text":"<p>No special configuration is needed for local development. When <code>NEPTUNE_HOST</code> is unset, the factory automatically creates a <code>LocalGraphAdapter</code> pointing to <code>localhost:18182</code> with <code>env_prefix=local</code>.</p>"},{"location":"developer-guide/graph-rag-configuration/#production-neptune-setup","title":"Production Neptune Setup","text":""},{"location":"developer-guide/graph-rag-configuration/#cluster-requirements","title":"Cluster Requirements","text":"<ul> <li>AWS Neptune with openCypher support</li> <li>IAM authentication enabled</li> <li>VPC peering or PrivateLink to EKS cluster</li> <li>The <code>neptune-connection</code> Kubernetes secret must contain: <code>host</code>, <code>port</code>, <code>region</code>, <code>iam_auth</code>, <code>env_prefix</code></li> </ul>"},{"location":"developer-guide/graph-rag-configuration/#iam-authentication","title":"IAM Authentication","text":"<p>In production, set <code>NEPTUNE_IAM_AUTH=true</code>. The <code>NeptuneGraphAdapter</code> signs requests using SigV4 with the pod's IAM role credentials (via IRSA). The service account needs the <code>neptune-db:*</code> permission on the cluster resource.</p>"},{"location":"developer-guide/graph-rag-configuration/#environment-prefix-isolation","title":"Environment Prefix Isolation","text":"<p>The <code>NEPTUNE_ENV_PREFIX</code> setting prefixes all graph labels and relationship types. This allows multiple environments (prod, staging, dev) to share a single Neptune cluster:</p> <ul> <li>Production: <code>prod-Person</code>, <code>prod-FAMILY_OF</code></li> <li>Staging: <code>staging-Person</code>, <code>staging-FAMILY_OF</code></li> <li>Local: <code>local-Person</code>, <code>local-FAMILY_OF</code></li> </ul> <p>Prefix consistency</p> <p>The prefix must be consistent across all services writing to the same graph. Changing the prefix after data has been written will make existing graph data invisible.</p>"},{"location":"developer-guide/graph-rag-configuration/#persona-tuning","title":"Persona Tuning","text":"<p>Persona traversal behavior is configured in <code>services/core-api/app/config/personas.yaml</code> under the <code>traversal</code> key for each persona. Changes take effect on the next application restart.</p>"},{"location":"developer-guide/graph-rag-configuration/#traversal-settings","title":"Traversal Settings","text":"Setting Type Description <code>max_hops</code> int Maximum graph traversal depth. Higher values discover more distant connections but increase latency. <code>relationship_weights</code> dict Weight multipliers for each relationship type (0.0-1.0). Higher weight = stronger signal for that relationship. <code>max_graph_results</code> int Maximum number of graph-discovered stories to return before access filtering. <code>include_cross_legacy</code> bool Whether to traverse across different legacy subjects' story graphs. <code>temporal_range</code> string Time range filter: <code>full</code> (all time), <code>recent</code> (last 10 years), <code>career</code> (working years)."},{"location":"developer-guide/graph-rag-configuration/#example-making-the-colleague-persona-broader","title":"Example: Making the Colleague Persona Broader","text":"<p>To make the Colleague persona discover more distant professional connections:</p> <pre><code>colleague:\n  traversal:\n    max_hops: 2              # was 1 \u2014 now traverses 2 hops\n    max_graph_results: 25     # was 15 \u2014 returns more results\n    relationship_weights:\n      FAMILY_OF: 0.2\n      KNEW: 0.6\n      WORKED_WITH: 1.0\n      FRIENDS_WITH: 0.5\n</code></pre> <p>Latency impact</p> <p>Increasing <code>max_hops</code> from 1 to 2 roughly doubles graph traversal time. Monitor the <code>core_api_graph_context_latency_seconds</code> metric after changes.</p>"},{"location":"developer-guide/graph-rag-configuration/#example-adding-a-new-relationship-type","title":"Example: Adding a New Relationship Type","text":"<p>To add support for a new relationship type (e.g., <code>MENTORED_BY</code>):</p> <ol> <li>Add the weight to each persona's traversal config in <code>personas.yaml</code></li> <li>Ensure the entity extraction prompt in <code>app/services/entity_extraction.py</code> recognizes mentorship relationships</li> <li>The graph traversal service will automatically include the new relationship type in queries</li> </ol>"},{"location":"developer-guide/graph-rag-configuration/#entity-backfill","title":"Entity Backfill","text":"<p>When deploying graph augmentation for the first time, existing stories need entity extraction and graph population.</p>"},{"location":"developer-guide/graph-rag-configuration/#running-locally","title":"Running Locally","text":"<pre><code>cd services/core-api\n\n# Preview what would be processed\nuv run python scripts/backfill_entities.py --dry-run\n\n# Process a small batch for testing\nuv run python scripts/backfill_entities.py --limit 10\n\n# Full backfill\nuv run python scripts/backfill_entities.py\n</code></pre> <p>The script processes stories sequentially with a 0.5-second delay between each to avoid Bedrock throttling.</p>"},{"location":"developer-guide/graph-rag-configuration/#running-in-production-kubernetes-job","title":"Running in Production (Kubernetes Job)","text":"<p>Enable the backfill job in Helm values:</p> <pre><code># infra/helm/mosaic-life/values.yaml\nentityBackfill:\n  enabled: true\n</code></pre> <p>The job runs as a Helm post-install/post-upgrade hook. It uses the same container image as the core API service. Set <code>enabled: false</code> after the initial backfill completes.</p>"},{"location":"developer-guide/graph-rag-configuration/#circuit-breaker-behavior","title":"Circuit Breaker Behavior","text":"<p>The circuit breaker protects the system when Neptune is unavailable.</p>"},{"location":"developer-guide/graph-rag-configuration/#states","title":"States","text":"State Behavior Transition Closed Normal operation \u2014 graph queries execute Opens after 3 consecutive failures Open All graph queries skipped \u2014 embedding-only fallback Transitions to half-open after 30 seconds Half-Open One trial request allowed Success closes the circuit; failure reopens it"},{"location":"developer-guide/graph-rag-configuration/#monitoring","title":"Monitoring","text":"<p>Use the Prometheus metric <code>core_api_graph_context_circuit_state</code> to monitor circuit breaker state:</p> <ul> <li><code>0</code> = closed (healthy)</li> <li><code>1</code> = open (Neptune unavailable, falling back)</li> <li><code>2</code> = half-open (recovery attempt in progress)</li> </ul> <p>Set up alerts for state <code>1</code> persisting beyond a few minutes \u2014 this indicates a Neptune connectivity issue that needs attention.</p>"},{"location":"developer-guide/graph-rag-configuration/#disabling-graph-augmentation","title":"Disabling Graph Augmentation","text":"<p>To disable all graph features and revert to embedding-only RAG:</p> <pre><code>GRAPH_AUGMENTATION_ENABLED=false\n</code></pre> <p>This is a clean toggle \u2014 the system behaves exactly as it did before graph augmentation was added. No other configuration changes are needed. Entity extraction during ingestion is also skipped.</p>"},{"location":"developer-guide/graph-rag-configuration/#troubleshooting","title":"Troubleshooting","text":""},{"location":"developer-guide/graph-rag-configuration/#neptune-connectivity-failures","title":"Neptune Connectivity Failures","text":"<p>Symptom: Circuit breaker opens frequently, logs show <code>circuit_breaker.opened</code>.</p> <p>Check: <pre><code># Local\ncurl http://localhost:18182\n\n# Production \u2014 from a pod in the same VPC\ncurl https://&lt;neptune-host&gt;:8182/status\n</code></pre></p> <p>Common causes: - Neptune cluster not running or unreachable - Security group / VPC peering misconfigured - IAM role missing <code>neptune-db:*</code> permissions</p>"},{"location":"developer-guide/graph-rag-configuration/#high-graph-latency","title":"High Graph Latency","text":"<p>Symptom: <code>core_api_graph_context_latency_seconds{phase=\"graph\"}</code> consistently above 500ms.</p> <p>Check: - Reduce <code>max_hops</code> in persona traversal configs - Reduce <code>max_graph_results</code> - Check Neptune cluster instance size and CPU utilization</p>"},{"location":"developer-guide/graph-rag-configuration/#entity-extraction-returning-empty-results","title":"Entity Extraction Returning Empty Results","text":"<p>Symptom: Stories are ingested but no entities appear in the graph.</p> <p>Check: - Verify <code>GRAPH_AUGMENTATION_ENABLED=true</code> - Check Bedrock model access \u2014 the extraction model must be enabled in your AWS account - Review logs for <code>entity_extraction.parse_failed</code> \u2014 the LLM response may not be valid JSON - Try extracting manually: check the entity extraction service logs for the raw LLM response</p>"},{"location":"developer-guide/graph-rag-configuration/#circuit-breaker-stuck-open","title":"Circuit Breaker Stuck Open","text":"<p>Symptom: <code>core_api_graph_context_circuit_state{state=\"1\"}</code> persists after Neptune is confirmed healthy.</p> <p>Resolution: The circuit breaker automatically transitions to half-open after 30 seconds. If Neptune is healthy but the circuit remains open, the half-open trial request may be failing. Check Neptune logs for the specific query that fails. Restarting the core API pod resets the circuit breaker.</p>"},{"location":"developer-guide/graph-rag-configuration/#debug-mode","title":"Debug Mode","text":"<p>Add <code>?debug=true</code> to persona chat API calls to see the full context assembly metadata in the response, including:</p> <ul> <li>Intent classification and confidence</li> <li>Number of embedding vs. graph results</li> <li>Latency breakdown by phase</li> <li>Circuit breaker state</li> <li>Source types for each result</li> </ul>"},{"location":"developer-guide/local-setup/","title":"Local Development Setup","text":"<p>This guide provides detailed instructions for setting up a development environment.</p>"},{"location":"developer-guide/local-setup/#prerequisites","title":"Prerequisites","text":""},{"location":"developer-guide/local-setup/#required-tools","title":"Required Tools","text":"Tool Version Purpose Docker 24+ Container runtime Docker Compose 2.20+ Local orchestration Node.js 20+ Frontend development Python 3.12+ Backend development uv Latest Python package manager"},{"location":"developer-guide/local-setup/#optional-tools","title":"Optional Tools","text":"<ul> <li>Just (command runner)</li> <li>VS Code with recommended extensions</li> </ul>"},{"location":"developer-guide/local-setup/#full-stack-setup","title":"Full Stack Setup","text":"<pre><code># Start all services\ndocker compose -f infra/compose/docker-compose.yml up -d\n\n# View logs\ndocker compose -f infra/compose/docker-compose.yml logs -f\n</code></pre>"},{"location":"developer-guide/local-setup/#frontend-only","title":"Frontend Only","text":"<pre><code>cd apps/web\nnpm install\nnpm run dev\n</code></pre>"},{"location":"developer-guide/local-setup/#backend-only","title":"Backend Only","text":"<pre><code>cd services/core-api\nuv sync\nuv run alembic upgrade head\nuv run python -m app.main\n</code></pre>"},{"location":"developer-guide/local-setup/#database-access","title":"Database Access","text":"<pre><code>docker compose -f infra/compose/docker-compose.yml exec postgres psql -U postgres -d core\n</code></pre>"},{"location":"getting-started/first-steps/","title":"First Steps","text":"<p>After installation, follow these steps to get started with Mosaic Life.</p>"},{"location":"getting-started/first-steps/#create-an-account","title":"Create an Account","text":"<ol> <li>Navigate to http://localhost:5173</li> <li>Click \"Sign in with Google\"</li> <li>Complete the OAuth flow</li> </ol>"},{"location":"getting-started/first-steps/#create-your-first-legacy","title":"Create Your First Legacy","text":"<p>A legacy is a collection of stories about a person's life.</p> <ol> <li>Click \"Create Legacy\" from the dashboard</li> <li>Enter the person's name and details</li> <li>Add your first story</li> </ol>"},{"location":"getting-started/first-steps/#next-steps","title":"Next Steps","text":"<ul> <li>Learn about Creating Stories</li> <li>Invite family members to Share Memories</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>This guide covers setting up Mosaic Life for local development.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker and Docker Compose</li> <li>Node.js 20+</li> <li>Python 3.12+</li> <li>uv (Python package manager)</li> </ul>"},{"location":"getting-started/installation/#quick-start","title":"Quick Start","text":"<ol> <li> <p>Clone the repository:</p> <pre><code>git clone https://github.com/mosaic-stories/mosaic-life.git\ncd mosaic-life\n</code></pre> </li> <li> <p>Start all services:</p> <pre><code>docker compose -f infra/compose/docker-compose.yml up -d\n</code></pre> </li> <li> <p>Access the application:</p> <ul> <li>Frontend: http://localhost:5173</li> <li>API: http://localhost:8080</li> <li>API Docs: http://localhost:8080/docs</li> </ul> </li> </ol>"},{"location":"reference/python/","title":"Python API Reference","text":"<p>Auto-generated documentation for the Mosaic Life backend (FastAPI).</p>"},{"location":"reference/python/#modules","title":"Modules","text":""},{"location":"reference/python/#app.main","title":"app.main","text":""},{"location":"reference/python/#app.config","title":"app.config","text":"<p>Configuration module for the core API.</p>"},{"location":"reference/python/#app.config.PersonaConfig","title":"PersonaConfig  <code>dataclass</code>","text":"<pre><code>PersonaConfig(id, name, icon, description, model_id, system_prompt, max_tokens=1024, traversal=TraversalConfig())\n</code></pre> <p>Configuration for an AI persona.</p>"},{"location":"reference/python/#app.config.build_system_prompt","title":"build_system_prompt","text":"<pre><code>build_system_prompt(persona_id, legacy_name, story_context='', facts=None, elicitation_mode=False, original_story_text=None, include_graph_suggestions=False)\n</code></pre> <p>Build complete system prompt for a persona with legacy context.</p> <p>Parameters:</p> Name Type Description Default <code>persona_id</code> <code>str</code> <p>The persona identifier.</p> required <code>legacy_name</code> <code>str</code> <p>Name of the legacy being discussed.</p> required <code>story_context</code> <code>str</code> <p>Retrieved story context to include in prompt.</p> <code>''</code> <code>facts</code> <code>list[Any] | None</code> <p>Optional list of LegacyFact objects to inject.</p> <code>None</code> <code>elicitation_mode</code> <code>bool</code> <p>Whether to append elicitation mode directive.</p> <code>False</code> <code>original_story_text</code> <code>str | None</code> <p>The story text being evolved (used in elicitation mode).</p> <code>None</code> <code>include_graph_suggestions</code> <code>bool</code> <p>Whether to append the graph suggestions directive (only relevant when elicitation_mode is True).</p> <code>False</code> <p>Returns:</p> Type Description <code>str | None</code> <p>Complete system prompt with base rules, persona prompt, story context,</p> <code>str | None</code> <p>and known facts, or None if persona not found.</p>"},{"location":"reference/python/#app.config.get_base_rules","title":"get_base_rules","text":"<pre><code>get_base_rules()\n</code></pre> <p>Get the base safety rules that apply to all personas.</p> <p>Returns:</p> Type Description <code>str</code> <p>Base rules string.</p>"},{"location":"reference/python/#app.config.get_persona","title":"get_persona","text":"<pre><code>get_persona(persona_id)\n</code></pre> <p>Get a specific persona by ID.</p> <p>Parameters:</p> Name Type Description Default <code>persona_id</code> <code>str</code> <p>The persona identifier.</p> required <p>Returns:</p> Type Description <code>PersonaConfig | None</code> <p>PersonaConfig if found, None otherwise.</p>"},{"location":"reference/python/#app.config.get_personas","title":"get_personas","text":"<pre><code>get_personas()\n</code></pre> <p>Get all available personas.</p> <p>Returns:</p> Type Description <code>list[PersonaConfig]</code> <p>List of all persona configurations.</p>"},{"location":"reference/python/#app.config.load_personas","title":"load_personas","text":"<pre><code>load_personas()\n</code></pre> <p>Load persona configurations from YAML file.</p> <p>Returns:</p> Type Description <code>dict[str, PersonaConfig]</code> <p>Dictionary mapping persona_id to PersonaConfig.</p>"},{"location":"reference/python/#app.models","title":"app.models","text":"<p>SQLAlchemy models for the application.</p>"},{"location":"reference/python/#app.models.AIConversation","title":"AIConversation","text":"<p>               Bases: <code>Base</code></p> <p>AI conversation model for tracking chat sessions.</p>"},{"location":"reference/python/#app.models.AIMessage","title":"AIMessage","text":"<p>               Bases: <code>Base</code></p> <p>AI message model for storing conversation messages.</p>"},{"location":"reference/python/#app.models.ConversationLegacy","title":"ConversationLegacy","text":"<p>               Bases: <code>Base</code></p> <p>Association between AI conversations and legacies.</p>"},{"location":"reference/python/#app.models.MediaLegacy","title":"MediaLegacy","text":"<p>               Bases: <code>Base</code></p> <p>Association between media and legacies.</p>"},{"location":"reference/python/#app.models.StoryLegacy","title":"StoryLegacy","text":"<p>               Bases: <code>Base</code></p> <p>Association between stories and legacies.</p>"},{"location":"reference/python/#app.models.Invitation","title":"Invitation","text":"<p>               Bases: <code>Base</code></p> <p>Invitation model for inviting users to join a legacy.</p>"},{"location":"reference/python/#app.models.Invitation.is_pending","title":"is_pending  <code>property</code>","text":"<pre><code>is_pending\n</code></pre> <p>Check if invitation is still pending.</p>"},{"location":"reference/python/#app.models.Invitation.is_expired","title":"is_expired  <code>property</code>","text":"<pre><code>is_expired\n</code></pre> <p>Check if invitation has expired.</p>"},{"location":"reference/python/#app.models.Invitation.status","title":"status  <code>property</code>","text":"<pre><code>status\n</code></pre> <p>Get the current status of the invitation.</p>"},{"location":"reference/python/#app.models.KnowledgeAuditLog","title":"KnowledgeAuditLog","text":"<p>               Bases: <code>Base</code></p> <p>Audit log for knowledge base operations.</p>"},{"location":"reference/python/#app.models.StoryChunk","title":"StoryChunk","text":"<p>               Bases: <code>Base</code></p> <p>Vector embedding chunk for a story segment.</p>"},{"location":"reference/python/#app.models.Legacy","title":"Legacy","text":"<p>               Bases: <code>Base</code></p> <p>Legacy model representing a person being remembered.</p>"},{"location":"reference/python/#app.models.LegacyMember","title":"LegacyMember","text":"<p>               Bases: <code>Base</code></p> <p>LegacyMember model for access control and join requests.</p>"},{"location":"reference/python/#app.models.LegacyLink","title":"LegacyLink","text":"<p>               Bases: <code>Base</code></p> <p>Consent-based link between two legacies about the same Person.</p>"},{"location":"reference/python/#app.models.LegacyLinkShare","title":"LegacyLinkShare","text":"<p>               Bases: <code>Base</code></p> <p>Per-story/media sharing permission for an active legacy link.</p>"},{"location":"reference/python/#app.models.ConversationChunk","title":"ConversationChunk","text":"<p>               Bases: <code>Base</code></p> <p>Vectorized summary of a conversation segment for RAG retrieval.</p>"},{"location":"reference/python/#app.models.LegacyFact","title":"LegacyFact","text":"<p>               Bases: <code>Base</code></p> <p>Per-user-per-legacy factual observation extracted from conversations.</p>"},{"location":"reference/python/#app.models.Media","title":"Media","text":"<p>               Bases: <code>Base</code></p> <p>Media model for uploaded files.</p>"},{"location":"reference/python/#app.models.Notification","title":"Notification","text":"<p>               Bases: <code>Base</code></p> <p>Notification model for user notifications.</p>"},{"location":"reference/python/#app.models.Person","title":"Person","text":"<p>               Bases: <code>Base</code></p> <p>Canonical identity for a real-world person.</p> <p>Multiple Legacies can reference the same Person. This enables identity matching, legacy linking, and shared content access.</p>"},{"location":"reference/python/#app.models.Story","title":"Story","text":"<p>               Bases: <code>Base</code></p> <p>Story model for user-written stories about legacies.</p>"},{"location":"reference/python/#app.models.StoryEvolutionSession","title":"StoryEvolutionSession","text":"<p>               Bases: <code>Base</code></p> <p>Orchestrates the story evolution workflow state.</p>"},{"location":"reference/python/#app.models.StoryEvolutionSession.is_terminal","title":"is_terminal  <code>property</code>","text":"<pre><code>is_terminal\n</code></pre> <p>Check if the session is in a terminal phase.</p>"},{"location":"reference/python/#app.models.StoryEvolutionSession.can_transition_to","title":"can_transition_to","text":"<pre><code>can_transition_to(target_phase)\n</code></pre> <p>Check if transition to target phase is allowed.</p>"},{"location":"reference/python/#app.models.StoryVersion","title":"StoryVersion","text":"<p>               Bases: <code>Base</code></p> <p>A snapshot of a story at a point in time.</p>"},{"location":"reference/python/#app.models.SupportRequest","title":"SupportRequest","text":"<p>               Bases: <code>Base</code></p> <p>Support request model for user help tickets.</p>"},{"location":"reference/python/#app.models.User","title":"User","text":"<p>               Bases: <code>Base</code></p> <p>User model representing authenticated users via Google OAuth.</p>"},{"location":"reference/python/#app.models.UserSession","title":"UserSession","text":"<p>               Bases: <code>Base</code></p> <p>User session model for tracking active login sessions.</p>"},{"location":"reference/python/#app.schemas","title":"app.schemas","text":"<p>Pydantic schemas for API request/response validation.</p>"},{"location":"reference/python/#app.schemas.InvitationAcceptResponse","title":"InvitationAcceptResponse","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for successful invitation acceptance.</p>"},{"location":"reference/python/#app.schemas.InvitationCreate","title":"InvitationCreate","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for creating an invitation.</p> <p>Either email or user_id must be provided, but not both.</p>"},{"location":"reference/python/#app.schemas.InvitationCreate.validate_email_or_user_id","title":"validate_email_or_user_id","text":"<pre><code>validate_email_or_user_id()\n</code></pre> <p>Ensure exactly one of email or user_id is provided.</p>"},{"location":"reference/python/#app.schemas.InvitationPreview","title":"InvitationPreview","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for invitation preview (shown to invitee before accepting).</p>"},{"location":"reference/python/#app.schemas.InvitationResponse","title":"InvitationResponse","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for invitation response.</p>"},{"location":"reference/python/#app.schemas.LegacyCreate","title":"LegacyCreate","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for creating a new legacy.</p>"},{"location":"reference/python/#app.schemas.LegacyMemberResponse","title":"LegacyMemberResponse","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for legacy member information.</p>"},{"location":"reference/python/#app.schemas.LegacyResponse","title":"LegacyResponse","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for legacy response.</p>"},{"location":"reference/python/#app.schemas.LegacySearchResponse","title":"LegacySearchResponse","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for legacy search results.</p>"},{"location":"reference/python/#app.schemas.LegacyUpdate","title":"LegacyUpdate","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for updating an existing legacy.</p>"},{"location":"reference/python/#app.schemas.UserSearchResult","title":"UserSearchResult","text":"<p>               Bases: <code>BaseModel</code></p> <p>Schema for user search result.</p>"},{"location":"reference/python/#app.routes","title":"app.routes","text":"<p>API route handlers.</p>"},{"location":"reference/typescript/","title":"TypeScript API Reference","text":"<p>Auto-generated documentation for the Mosaic Life frontend (React).</p> <p>Build-time Generation</p> <p>This documentation is generated from TypeScript source code during the docs build process.</p>"},{"location":"user-guide/ai-personas/","title":"AI Personas &amp; Smart Connections","text":"<p>When you have a conversation about your loved one, Mosaic Life's AI personas draw on everything you've shared to provide meaningful, connected responses. Each persona brings a different perspective to your memories, and the system automatically discovers connections between stories, people, places, and events.</p>"},{"location":"user-guide/ai-personas/#meet-the-personas","title":"Meet the Personas","text":"Persona Focus Best For The Biographer Life Story Curator Organizing memories into themes and timelines, identifying gaps in the narrative, connecting stories across life chapters The Friend Empathetic Listener Emotional support during the memorial process, reflecting feelings, celebrating joyful memories alongside difficult ones The Colleague Professional Companion Exploring career milestones, work relationships, mentorship stories, and professional impact The Family Member Family Historian Family bonds and traditions, generational connections, holidays and gatherings, family roles <p>Each persona uses the same underlying stories and memories, but approaches them from a different angle. Try switching personas to discover new dimensions of the stories you've shared.</p>"},{"location":"user-guide/ai-personas/#how-smart-connections-work","title":"How Smart Connections Work","text":"<p>As you share stories, the system automatically identifies people, places, events, and meaningful objects mentioned in each memory. These are connected together behind the scenes, creating a web of relationships between your stories. When you mention Uncle Jim's trip to Chicago, the system can surface related stories about other family trips, other memories involving Uncle Jim, or even stories from other family members that took place in Chicago.</p> <p>This means your conversations become richer over time. The more stories you share, the more connections the system can discover and suggest.</p>"},{"location":"user-guide/ai-personas/#what-to-expect","title":"What to Expect","text":"<ul> <li>Related stories in conversations \u2014 When you're discussing a topic, the persona may reference other stories that connect to what you're talking about.</li> <li>Exploration suggestions \u2014 Personas may gently suggest directions to explore, like \"There's another story about that same summer \u2014 would you like to talk about it?\"</li> <li>Cross-family connections \u2014 If multiple family members have stories that intersect (same places, events, or people), the system can surface those connections.</li> <li>Richer story evolution \u2014 When you start a new conversation to expand on an existing story, the opening message reflects connections to related stories.</li> </ul>"},{"location":"user-guide/ai-personas/#tips-for-better-conversations","title":"Tips for Better Conversations","text":"<ul> <li>Share specific details \u2014 Names, places, dates, and events help the system make stronger connections between stories.</li> <li>Mention relationships \u2014 Saying \"my mother's brother Jim\" gives the system more to work with than just \"Jim.\"</li> <li>Try different personas \u2014 The Biographer might help you organize a timeline, while The Friend helps you process the emotions around the same memory.</li> <li>Build on existing stories \u2014 Use the story evolution feature to expand on stories you've already shared. The system will bring in relevant connections automatically.</li> <li>Don't worry about order \u2014 Share memories as they come to you. The system connects them regardless of when you share them.</li> </ul>"},{"location":"user-guide/creating-stories/","title":"Creating Stories","text":"<p>Stories are the heart of Mosaic Life. Each story captures a memory, moment, or milestone.</p>"},{"location":"user-guide/creating-stories/#writing-a-story","title":"Writing a Story","text":"<ol> <li>Open a legacy</li> <li>Click \"Add Story\"</li> <li>Enter a title and start writing</li> </ol>"},{"location":"user-guide/creating-stories/#using-the-editor","title":"Using the Editor","text":"<p>The story editor supports rich text formatting:</p> <ul> <li>Bold and italic text</li> <li>Headers and lists</li> <li>Images and media</li> <li>Links</li> </ul>"},{"location":"user-guide/creating-stories/#saving-and-publishing","title":"Saving and Publishing","text":"<p>Stories are saved automatically as drafts. When ready, click \"Publish\" to share with legacy members.</p>"},{"location":"user-guide/sharing-memories/","title":"Sharing Memories","text":"<p>Mosaic Life is designed for collaborative storytelling. Invite family and friends to contribute.</p>"},{"location":"user-guide/sharing-memories/#inviting-members","title":"Inviting Members","text":"<ol> <li>Open a legacy</li> <li>Click \"Members\"</li> <li>Enter email addresses to invite</li> </ol>"},{"location":"user-guide/sharing-memories/#member-roles","title":"Member Roles","text":"<ul> <li>Owner: Full control, can delete legacy</li> <li>Editor: Can add and edit stories</li> <li>Viewer: Read-only access</li> </ul>"},{"location":"user-guide/sharing-memories/#privacy-settings","title":"Privacy Settings","text":"<p>Control who can see your legacy:</p> <ul> <li>Private: Only invited members</li> <li>Family: Extended family with link</li> <li>Public: Anyone with the link</li> </ul>"}]}